{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/shuowang/ETM/Leekdao/leekdao-farm/src/views/Billboard/Map/MapBox.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport MapGL, { Popup, NavigationControl, FullscreenControl, ScaleControl, GeolocateControl } from 'react-map-gl';\nimport Pins from './Pins';\nimport BillboardForm from './BillboardForm';\nimport BillboardDetails from './BillboardDetails';\nimport { useGetBillboardDetails } from \"../api/index\";\nimport { bidStore } from \"../store/store\";\nimport { HIDE_FORM } from '../store/reducer';\nconst TOKEN = process.env.REACT_APP_MAP_TOKEN;\nconst geolocateStyle = {\n  top: 0,\n  left: 0,\n  padding: '10px'\n};\nconst fullscreenControlStyle = {\n  top: 36,\n  left: 0,\n  padding: '10px'\n};\nconst navStyle = {\n  top: 72,\n  left: 0,\n  padding: '10px'\n};\nconst scaleControlStyle = {\n  bottom: 36,\n  left: 0,\n  padding: '10px'\n};\n\nconst Map = () => {\n  _s();\n\n  const [viewport, setViewport] = useState({\n    latitude: 51.29,\n    longitude: 0,\n    zoom: 1.5,\n    bearing: 0,\n    pitch: 0\n  });\n  const cities = useGetBillboardDetails();\n  const {\n    show\n  } = bidStore.getState();\n  const [popupInfo, setPopupInfo] = useState(null);\n  useEffect(() => {\n    const mapbox = document.getElementsByClassName('mapboxgl-map')[0];\n\n    if (mapbox) {\n      if (popupInfo) {\n        mapbox.setAttribute(\"style\", \"position: absolute; width: 100%; height: 100%; overflow: hidden; visibility: inherit; opacity:50%\");\n      } else {\n        mapbox.setAttribute('style', 'position: absolute; width: 100%; height: 100%; overflow: hidden; visibility: inherit;');\n      }\n    }\n  }, [popupInfo]);\n\n  let comp = /*#__PURE__*/_jsxDEV(BillboardForm, {\n    info: popupInfo\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 16\n  }, this);\n\n  if (popupInfo && popupInfo.ipfsHash) {\n    if (show) {\n      comp = /*#__PURE__*/_jsxDEV(BillboardForm, {\n        info: popupInfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 20\n      }, this);\n    } else {\n      comp = /*#__PURE__*/_jsxDEV(BillboardDetails, {\n        info: popupInfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 20\n      }, this);\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(MapGL, { ...viewport,\n      width: \"100%\",\n      height: \"100vh\",\n      mapStyle: \"mapbox://styles/mapbox/streets-v11\",\n      onViewportChange: setViewport,\n      mapboxApiAccessToken: TOKEN,\n      children: [/*#__PURE__*/_jsxDEV(Pins, {\n        data: cities,\n        onClick: setPopupInfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this), popupInfo && /*#__PURE__*/_jsxDEV(Popup, {\n        tipSize: 10,\n        anchor: \"bottom\",\n        longitude: popupInfo.longitude,\n        latitude: popupInfo.latitude,\n        closeOnClick: false,\n        onClose: () => {\n          setPopupInfo(null);\n          bidStore.dispatch({\n            type: HIDE_FORM\n          });\n        },\n        children: comp\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(GeolocateControl, {\n        style: geolocateStyle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(FullscreenControl, {\n        style: fullscreenControlStyle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(NavigationControl, {\n        style: navStyle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ScaleControl, {\n        style: scaleControlStyle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n};\n\n_s(Map, \"UTOV4FoSgw4f5vsASuV1uOlDuLk=\", false, function () {\n  return [useGetBillboardDetails];\n});\n\n_c = Map;\nexport default Map;\n\nvar _c;\n\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"sources":["/Users/shuowang/ETM/Leekdao/leekdao-farm/src/views/Billboard/Map/MapBox.tsx"],"names":["React","useState","useEffect","MapGL","Popup","NavigationControl","FullscreenControl","ScaleControl","GeolocateControl","Pins","BillboardForm","BillboardDetails","useGetBillboardDetails","bidStore","HIDE_FORM","TOKEN","process","env","REACT_APP_MAP_TOKEN","geolocateStyle","top","left","padding","fullscreenControlStyle","navStyle","scaleControlStyle","bottom","Map","viewport","setViewport","latitude","longitude","zoom","bearing","pitch","cities","show","getState","popupInfo","setPopupInfo","mapbox","document","getElementsByClassName","setAttribute","comp","ipfsHash","dispatch","type"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,IACIC,KADJ,EAEIC,iBAFJ,EAGIC,iBAHJ,EAIIC,YAJJ,EAKIC,gBALJ,QAMO,cANP;AAOA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,aAAP,MAA0B,iBAA1B;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,SAASC,sBAAT,QAAuC,cAAvC;AACA,SAASC,QAAT,QAAyB,gBAAzB;AACA,SAASC,SAAT,QAA0B,kBAA1B;AAEA,MAAMC,KAAK,GAAGC,OAAO,CAACC,GAAR,CAAYC,mBAA1B;AAEA,MAAMC,cAAc,GAAG;AACnBC,EAAAA,GAAG,EAAE,CADc;AAEnBC,EAAAA,IAAI,EAAE,CAFa;AAGnBC,EAAAA,OAAO,EAAE;AAHU,CAAvB;AAMA,MAAMC,sBAAsB,GAAG;AAC3BH,EAAAA,GAAG,EAAE,EADsB;AAE3BC,EAAAA,IAAI,EAAE,CAFqB;AAG3BC,EAAAA,OAAO,EAAE;AAHkB,CAA/B;AAMA,MAAME,QAAQ,GAAG;AACbJ,EAAAA,GAAG,EAAE,EADQ;AAEbC,EAAAA,IAAI,EAAE,CAFO;AAGbC,EAAAA,OAAO,EAAE;AAHI,CAAjB;AAMA,MAAMG,iBAAiB,GAAG;AACtBC,EAAAA,MAAM,EAAE,EADc;AAEtBL,EAAAA,IAAI,EAAE,CAFgB;AAGtBC,EAAAA,OAAO,EAAE;AAHa,CAA1B;;AAMA,MAAMK,GAAG,GAAG,MAAM;AAAA;;AACd,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0B5B,QAAQ,CAAC;AACrC6B,IAAAA,QAAQ,EAAE,KAD2B;AAErCC,IAAAA,SAAS,EAAE,CAF0B;AAGrCC,IAAAA,IAAI,EAAE,GAH+B;AAIrCC,IAAAA,OAAO,EAAE,CAJ4B;AAKrCC,IAAAA,KAAK,EAAE;AAL8B,GAAD,CAAxC;AAQA,QAAMC,MAAM,GAAGvB,sBAAsB,EAArC;AAEA,QAAM;AAAEwB,IAAAA;AAAF,MAAWvB,QAAQ,CAACwB,QAAT,EAAjB;AAEA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BtC,QAAQ,CAAC,IAAD,CAA1C;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMsC,MAAM,GAAGC,QAAQ,CAACC,sBAAT,CAAgC,cAAhC,EAAgD,CAAhD,CAAf;;AACA,QAAIF,MAAJ,EAAY;AACR,UAAIF,SAAJ,EAAe;AACXE,QAAAA,MAAM,CAACG,YAAP,CAAoB,OAApB,EAA6B,mGAA7B;AACH,OAFD,MAEO;AACHH,QAAAA,MAAM,CAACG,YAAP,CAAoB,OAApB,EAA6B,uFAA7B;AAEH;AACJ;AACJ,GAVQ,EAUN,CAACL,SAAD,CAVM,CAAT;;AAYA,MAAIM,IAAI,gBAAG,QAAC,aAAD;AAAe,IAAA,IAAI,EAAEN;AAArB;AAAA;AAAA;AAAA;AAAA,UAAX;;AAEA,MAAIA,SAAS,IAAIA,SAAS,CAACO,QAA3B,EAAqC;AACjC,QAAIT,IAAJ,EAAU;AACNQ,MAAAA,IAAI,gBAAG,QAAC,aAAD;AAAe,QAAA,IAAI,EAAEN;AAArB;AAAA;AAAA;AAAA;AAAA,cAAP;AACH,KAFD,MAEO;AACHM,MAAAA,IAAI,gBAAG,QAAC,gBAAD;AAAkB,QAAA,IAAI,EAAEN;AAAxB;AAAA;AAAA;AAAA;AAAA,cAAP;AACH;AACJ;;AAGD,sBACI;AAAA,2BACI,QAAC,KAAD,OACQV,QADR;AAEI,MAAA,KAAK,EAAC,MAFV;AAGI,MAAA,MAAM,EAAC,OAHX;AAII,MAAA,QAAQ,EAAC,oCAJb;AAKI,MAAA,gBAAgB,EAAEC,WALtB;AAMI,MAAA,oBAAoB,EAAEd,KAN1B;AAAA,8BASI,QAAC,IAAD;AAAM,QAAA,IAAI,EAAEoB,MAAZ;AAAoB,QAAA,OAAO,EAAEI;AAA7B;AAAA;AAAA;AAAA;AAAA,cATJ,EAWKD,SAAS,iBACN,QAAC,KAAD;AACI,QAAA,OAAO,EAAE,EADb;AAEI,QAAA,MAAM,EAAC,QAFX;AAGI,QAAA,SAAS,EAAEA,SAAS,CAACP,SAHzB;AAII,QAAA,QAAQ,EAAEO,SAAS,CAACR,QAJxB;AAKI,QAAA,YAAY,EAAE,KALlB;AAMI,QAAA,OAAO,EAAE,MAAM;AACXS,UAAAA,YAAY,CAAC,IAAD,CAAZ;AACA1B,UAAAA,QAAQ,CAACiC,QAAT,CAAkB;AAAEC,YAAAA,IAAI,EAAEjC;AAAR,WAAlB;AACH,SATL;AAAA,kBAYK8B;AAZL;AAAA;AAAA;AAAA;AAAA,cAZR,eA4BI,QAAC,gBAAD;AAAkB,QAAA,KAAK,EAAEzB;AAAzB;AAAA;AAAA;AAAA;AAAA,cA5BJ,eA6BI,QAAC,iBAAD;AAAmB,QAAA,KAAK,EAAEI;AAA1B;AAAA;AAAA;AAAA;AAAA,cA7BJ,eA8BI,QAAC,iBAAD;AAAmB,QAAA,KAAK,EAAEC;AAA1B;AAAA;AAAA;AAAA;AAAA,cA9BJ,eA+BI,QAAC,YAAD;AAAc,QAAA,KAAK,EAAEC;AAArB;AAAA;AAAA;AAAA;AAAA,cA/BJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ,mBADJ;AAqCH,CA3ED;;GAAME,G;UASaf,sB;;;KATbe,G;AA6EN,eAAeA,GAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport MapGL, {\n    Popup,\n    NavigationControl,\n    FullscreenControl,\n    ScaleControl,\n    GeolocateControl\n} from 'react-map-gl';\nimport Pins from './Pins';\nimport BillboardForm from './BillboardForm';\nimport BillboardDetails from './BillboardDetails';\nimport { useGetBillboardDetails } from \"../api/index\"\nimport { bidStore } from \"../store/store\"\nimport { HIDE_FORM } from '../store/reducer';\n\nconst TOKEN = process.env.REACT_APP_MAP_TOKEN\n\nconst geolocateStyle = {\n    top: 0,\n    left: 0,\n    padding: '10px'\n};\n\nconst fullscreenControlStyle = {\n    top: 36,\n    left: 0,\n    padding: '10px'\n};\n\nconst navStyle = {\n    top: 72,\n    left: 0,\n    padding: '10px'\n};\n\nconst scaleControlStyle = {\n    bottom: 36,\n    left: 0,\n    padding: '10px'\n};\n\nconst Map = () => {\n    const [viewport, setViewport] = useState({\n        latitude: 51.29,\n        longitude: 0,\n        zoom: 1.5,\n        bearing: 0,\n        pitch: 0\n    });\n\n    const cities = useGetBillboardDetails();\n\n    const { show } = bidStore.getState()\n\n    const [popupInfo, setPopupInfo] = useState(null);\n\n    useEffect(() => {\n        const mapbox = document.getElementsByClassName('mapboxgl-map')[0]\n        if (mapbox) {\n            if (popupInfo) {\n                mapbox.setAttribute(\"style\", \"position: absolute; width: 100%; height: 100%; overflow: hidden; visibility: inherit; opacity:50%\")\n            } else {\n                mapbox.setAttribute('style', 'position: absolute; width: 100%; height: 100%; overflow: hidden; visibility: inherit;')\n\n            }\n        }\n    }, [popupInfo])\n\n    let comp = <BillboardForm info={popupInfo} />;\n\n    if (popupInfo && popupInfo.ipfsHash) {\n        if (show) {\n            comp = <BillboardForm info={popupInfo} />\n        } else {\n            comp = <BillboardDetails info={popupInfo} />\n        }\n    }\n\n\n    return (\n        <>\n            <MapGL\n                {...viewport}\n                width=\"100%\"\n                height=\"100vh\"\n                mapStyle=\"mapbox://styles/mapbox/streets-v11\"\n                onViewportChange={setViewport}\n                mapboxApiAccessToken={TOKEN}\n            >\n\n                <Pins data={cities} onClick={setPopupInfo} />\n\n                {popupInfo && (\n                    <Popup\n                        tipSize={10}\n                        anchor=\"bottom\"\n                        longitude={popupInfo.longitude}\n                        latitude={popupInfo.latitude}\n                        closeOnClick={false}\n                        onClose={() => {\n                            setPopupInfo(null)\n                            bidStore.dispatch({ type: HIDE_FORM })\n                        }\n                        }\n                    >\n                        {comp}\n                    </Popup>\n                )}\n\n                <GeolocateControl style={geolocateStyle} />\n                <FullscreenControl style={fullscreenControlStyle} />\n                <NavigationControl style={navStyle} />\n                <ScaleControl style={scaleControlStyle} />\n            </MapGL>\n        </>\n    );\n}\n\nexport default Map"]},"metadata":{},"sourceType":"module"}